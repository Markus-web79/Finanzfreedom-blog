name: ğŸš€ Build and Deploy Blog

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ§© Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ§© Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: ğŸ§© Install Dependencies
        run: npm install

      - name: ğŸ§© Install missing markdown renderer
        run: npm install react-markdown

      - name: ğŸ§  SEO QualitÃ¤tsprÃ¼fung
        run: |
          echo "ğŸ“Š PrÃ¼fe Artikel auf SEO-QualitÃ¤t..."
          node scripts/seoCheck.js

      - name: âœï¸ Generiere Artikel
        run: |
          echo "ğŸ“° Generiere neuen Artikel..."
          node scripts/generateArticle.js

      - name: âš–ï¸ Generiere Vergleichsartikel
        run: |
          echo "âš–ï¸ Generiere neuen Vergleichsartikel..."
          node scripts/generateComparison.js

      - name: ğŸ”— Interne Verlinkung
        run: |
          echo "ğŸ”— FÃ¼ge interne Links hinzu..."
          node scripts/linkInternal.js

      - name: ğŸ—ºï¸ Sitemap generieren
        run: |
          echo "ğŸ“ Generiere Sitemap..."
          node scripts/generateSitemap.js

      - name: ğŸ“° RSS Feed generieren
        run: |
          echo "ğŸ“¡ Erstelle RSS-Feed..."
          node scripts/generateFeed.js

      - name: ğŸ”” Suchmaschinen anpingen
        run: |
          echo "ğŸ”” Informiere Google & Bing..."
          node scripts/pingSearchEngines.js

      - name: ğŸš€ Deploy to Vercel
        run: npx vercel --prod --token=${{ secrets.VERCEL_TOKEN }}

      - name: ğŸ’¾ Backup generierter Inhalte
        run: |
          echo "ğŸ’¾ Erstelle Backup der Inhalte..."
          zip -r backup_$(date +%Y%m%d).zip content/
