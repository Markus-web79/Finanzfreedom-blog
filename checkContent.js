// checkContent.cjs
const fs = require("fs");
const path = require("path");

// W√∂rterbuch mit Korrekturen (kannst du erweitern)
const corrections = {
  "\\bteh\\b": "the",
  "\\brecieve\\b": "receive",
  "\\bfreedomm\\b": "freedom",
};

// Umlaute ersetzen (ue -> √º, ae -> √§, oe -> √∂, ss bleibt gleich)
function replaceUmlauts(text) {
  return text
    .replace(/ae/g, "√§")
    .replace(/oe/g, "√∂")
    .replace(/ue/g, "√º");
}

// Rechtschreibung korrigieren
function fixTypos(text) {
  for (const [wrong, correct] of Object.entries(corrections)) {
    const regex = new RegExp(wrong, "gi");
    text = text.replace(regex, correct);
  }
  return text;
}

function processFile(filePath) {
  let content = fs.readFileSync(filePath, "utf8");

  const original = content;
  content = replaceUmlauts(content);
  content = fixTypos(content);

  if (content !== original) {
    fs.writeFileSync(filePath, content, "utf8");
    console.log(`‚úÖ Korrigiert: ${filePath}`);
  } else {
    console.log(`‚ÑπÔ∏è Keine √Ñnderungen: ${filePath}`);
  }
}

function walkDir(dir) {
  fs.readdirSync(dir).forEach((file) => {
    const fullPath = path.join(dir, file);
    if (fs.statSync(fullPath).isDirectory()) {
      walkDir(fullPath);
    } else if (fullPath.endsWith(".md")) {
      processFile(fullPath);
    }
  });
}

console.log("üîç Starte Content-Check...");
walkDir(path.join(__dirname, "content"));
console.log("‚úÖ Content-Check abgeschlossen.");
