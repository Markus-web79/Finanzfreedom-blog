// checkContent.js
// L√§uft im Workflow: pr√ºft & korrigiert Content

const fs = require("fs");
const path = require("path");

// Ordner mit den Artikeln
const contentDir = path.join(__dirname, "content");

// Mapping f√ºr Umlaute und √ü
const replacements = {
  ae: "√§",
  oe: "√∂",
  ue: "√º",
  Ae: "√Ñ",
  Oe: "√ñ",
  Ue: "√ú",
  ss: "√ü",
};

// Hilfsfunktion: Text korrigieren
function fixText(text) {
  let fixed = text;

  // Ersetzungen f√ºr Umlaute
  for (const [wrong, right] of Object.entries(replacements)) {
    const regex = new RegExp(wrong, "g");
    fixed = fixed.replace(regex, right);
  }

  // Rechtschreibkorrektur: ste√ºr ‚Üí Steuer
  fixed = fixed.replace(/Ste√ºr/g, "Steuer");
  fixed = fixed.replace(/ste√ºr/g, "steuer");

  return fixed;
}

// Alle .md Dateien im content-Ordner durchgehen
fs.readdirSync(contentDir).forEach((file) => {
  if (file.endsWith(".md")) {
    const filePath = path.join(contentDir, file);
    const original = fs.readFileSync(filePath, "utf8");
    const fixed = fixText(original);

    if (original !== fixed) {
      fs.writeFileSync(filePath, fixed, "utf8");
      console.log(`‚úÖ Korrigiert: ${file}`);
    } else {
      console.log(`‚ÑπÔ∏è Keine √Ñnderungen: ${file}`);
    }
  }
});

console.log("üîç Content-Check abgeschlossen!");
